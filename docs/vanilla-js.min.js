function onPageReady(c){"loading"!==document.readyState&&(console.debug("onPageReady already completed, firing callback..."),c());console.debug("queuing onPageReady CB",document.readyState);document.addEventListener("DOMContentLoaded",c)}function onPageLoad(c){"complete"===document.readyState&&(console.debug("onPageReady already completed, firing callback..."),c());console.debug("queuing onPageLoad CB",document.readyState);window.addEventListener("load",c)}
var $=document.querySelector.bind(document),$all=document.querySelectorAll.bind(document),forEach=function(c,d,a){for(var b=0;b<c.length;b++)d.call(a,b,c[b])};NodeList.prototype.first=function(){return this.item(0)};function $find(c,d){return c.querySelectorAll(d)}function $append(c){document.body.insertAdjacentHTML("beforeend",c)}function $addClass(c,d){c.classList&&c.classList.add(d);c.className+=" "+d}
function $removeClass(c,d){c.classList&&c.classList.remove(d);c.className=c.className.replace(RegExp("(^|\\b)"+d.split(" ").join("|")+"(\\b|$)","gi")," ")}function $hasClass(c,d){return c.classList?c.classList.contains(d):RegExp("(^| )"+d+"( |$)","gi").test(c.className)}function $toggleClass(c,d){if(c.classList)c.classList.toggle(d);else{var a=c.className.split(" "),b=a.indexOf(d);0<=b?a.splice(b,1):a.push(d);c.className=a.join(" ")}}function $hide(c){c.style.display="none"}
function $show(c,d){c.style.display=d?d:""}function $detectSwipe(c,d,a){var b=0,g=0,h=0,k=0;a||(a=150);c.addEventListener("touchstart",function(a){b=a.changedTouches[0].screenX;g=a.changedTouches[0].screenY},!1);c.addEventListener("touchend",function(c){h=c.changedTouches[0].screenX;k=c.changedTouches[0].screenY;var e=h-b,f=k-g;if(Math.abs(e)>Math.abs(f)){if(Math.abs(e)>a)return 0>e?d("left",c):d("right",c)}else if(Math.abs(f)>a)return 0<f?d("down",c):d("up",c)},!1)}
function $triggerEvent(c,d){var a=document.createEvent("Event");a.initEvent(d,!0,!0);("string"===typeof c||c instanceof String?$(c):c).dispatchEvent(a)}function $on(c,d,a){$all(c).forEach(function(b){b.addEventListener(d,function(b){a(b,this)},!1)})};var lightboxInstanceCount=0;
function $lightbox(c,d){var a=this;a.initialized=!1;a.modal=null;a.modalImage=null;a.modalCaption=null;a.modalNext=null;a.modalPrev=null;a.images=[];a.currentIndex=0;a.singleMode=!1;a.isOpen=!1;a.checkModal=function(){lightboxInstanceCount++;var b="lightbox-modal-"+lightboxInstanceCount;console.debug("$lightbox: adding",b);$append('<figcaption id="'+b+'" class="lightbox-modal" style="position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.8);display:none;transition: opacity .5s ease-in-out;z-index:2;pointer-events: none">\n<figure style="position:absolute;top:0;left:0;right:0;bottom:0;display:flex;flex-direction:column;align-items: center;justify-content: center;"><img alt="" src="" style="width:100%;height:auto;max-height:100vh;object-fit:contain;opacity: 0;transition:opacity .5s ease-in-out" >\n<figcaption></figcaption></figure>\n<div class="lightbox-close" style="position:absolute;top:10px;right:10px;font-size:3rem;cursor:pointer;">&times;</div>\n<div class="lightbox-next" style="position:absolute;top:calc(50% - 3rem);right:10px;font-size:6rem;cursor:pointer;">&rsaquo;</div>\n<div class="lightbox-prev" style="position:absolute;top:calc(50% - 3rem);left:10px;font-size:6rem;cursor:pointer;">&lsaquo;</div>\n</div>');a.modal=
$("#"+b);a.modalImage=$find(a.modal,"img").first();a.modalCaption=$find(a.modal,"figcaption").first();b=$find(a.modal,".lightbox-close").first();a.modalNext=$find(a.modal,".lightbox-next").first();a.modalPrev=$find(a.modal,".lightbox-prev").first();$detectSwipe(a.modal,function(b){a.isOpen&&("left"===b?a.next():"right"===b&&a.prev())});window.addEventListener("keydown",function(b){if(a.isOpen){var c=b.key;"ArrowRight"===c?(b.preventDefault(),b.stopImmediatePropagation(),a.next()):"ArrowLeft"===c?
(b.preventDefault(),b.stopImmediatePropagation(),a.prev()):"Escape"===c?(b.preventDefault(),b.stopImmediatePropagation(),a.hide()):" "===c&&(b.preventDefault(),b.stopImmediatePropagation(),a.next())}});b.addEventListener("click",function(b){b.preventDefault();b.stopImmediatePropagation();a.hide()});a.modalImage.addEventListener("click",function(b){b.preventDefault();b.stopImmediatePropagation();a.next()});a.modalImage.addEventListener("load",function(){a.modalImage.style.opacity="1"});a.modalImage.addEventListener("error",
function(a){console.error("$lightbox: img loading error",a.target)});a.modalNext.addEventListener("click",function(b){b.preventDefault();b.stopImmediatePropagation();a.next()});a.modalPrev.addEventListener("click",function(b){b.preventDefault();b.stopImmediatePropagation();a.prev()})};a.scanElement=function(b){var c=b.getAttribute("data-src")||b.getAttribute("href")||b.getAttribute("src");if(c){var d=b.getAttribute("data-title")||b.getAttribute("title")||b.getAttribute("alt");d||(b=$find(b,"img").first())&&
(d=b.getAttribute("data-title")||b.getAttribute("title")||b.getAttribute("alt"));a.images.push([c,d])}else console.warn("$lightbox: element has no valid image url",b)};a.checkImages=function(){if(d){var b=$(c);$find(b,d).forEach(function(b){a.scanElement(b)});1===a.images.length&&(a.singleMode=!0)}else $all(c).forEach(function(b){a.scanElement(b)}),a.singleMode=!0};a.bootstrap=function(){a.initialized||(a.checkModal(),a.checkImages(),a.initialized=!0)};a.switchImage=function(b){a.currentIndex=b;a.modalImage.style.opacity=
"0";a.modalImage.setAttribute("title","");a.modalCaption.innerText="";var c=a.images[b][1];a.modalImage.src=a.images[b][0];c&&(a.modalImage.setAttribute("title",c),a.modalCaption.innerText=c)};a.show=function(b){a.hide();a.switchImage(b);$show(a.modal);a.isOpen=!0;$addClass(a.modal,"open");a.modal.style.pointerEvents="auto";setTimeout(function(){a.modal.style.opacity="1"},0);a.singleMode?($hide(a.modalPrev),$hide(a.modalNext)):($show(a.modalPrev),$show(a.modalNext))};a.hide=function(){$removeClass(a.modal,
"open");a.modal.style.pointerEvents="none";a.modal.style.opacity="0";a.isOpen=!1};a.next=function(){if(!a.singleMode){var b=a.currentIndex+1;if(b<a.images.length)return a.switchImage(b)}a.hide()};a.prev=function(){if(!a.singleMode){var b=a.currentIndex-1;if(0<=b)return a.switchImage(b)}a.hide()};a.detectUrl=function(b){b=b.getAttribute("data-src")||b.getAttribute("href")||b.getAttribute("src");for(var c=0;c<a.images.length;c++)if(a.images[c][0]===b)return c;return!1};$on(c,"click",function(b){a.bootstrap();
if(0===a.images.length)console.warn("$lightbox: no images found");else{b.preventDefault();b.stopImmediatePropagation();b=b.target;for(var d=a.detectUrl(b);!1===d;){if(b.matches(c)){console.warn("$lightbox: clicked element url not found in main selector");return}b=b.parentNode;if("function"!==typeof b.getAttribute){console.error("$lightbox: cannot find the clicked element in document");return}d=a.detectUrl(b)}return a.show(d)}})};
